#include <sys/types.h>
#include <sys/ptrace.h>
#include <stdio.h>
#include <string.h>

int auth(char *s1, int32_t arg_ch)
{
	s1[strcspn(s1, "\n")] = '\0';

	if ( strnlen(s1, 32) < 5 )
		return 1;

	if ( ptrace(0, 1, 0, 0) == -1 )
	{
		puts("\033[32m.---------------------------.");
		puts("\033[31m| !! TAMPERING DETECTED !!  |");
		puts("\033[32m.---------------------------.");
		return 1;
	}

	// TODO [...]
	return 0;
}

int main(int argc, const char *argv[])
{
	char s[32];
	int32_t size;

	puts("***********************************");
	puts("*\t\tlevel06\t\t  *");
	puts("***********************************");
	printf("-> Enter Login: ");

	fgets(s, 32, stdin);

	puts("***********************************");
	puts("***** NEW ACCOUNT DETECTED ********");
	puts("***********************************");

	printf("-> Enter Serial: ");
	scanf("%u", &size);
	auth(s, size);

	return 0;
}
